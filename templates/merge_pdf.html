<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{{ title }}</title>
  <style>
    body{font-family:system-ui,Segoe UI,Arial;margin:0;background:#0b0d12;color:#e5e7eb}
    .wrap{max-width:860px;margin:32px auto;padding:0 16px}
    .card{background:#111827;border:1px solid #1f2937;border-radius:14px;padding:20px}
    .btn{background:#ef4444;border:0;color:#fff;padding:10px 16px;border-radius:10px;cursor:pointer;font-weight:600}
    .btn:hover{background:#dc2626}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    input[type="text"],select{
      width:100%;padding:10px;border-radius:10px;border:1px solid #374151;background:#0b0f18;color:#e5e7eb
    }
    .drop{border:2px dashed #1f2937;border-radius:16px;padding:28px;text-align:center;margin:12px 0}
    .drop.drag{border-color:#ef4444;background:rgba(239,68,68,.06)}
    .muted{color:#9aa3b2;font-size:14px}
    a.link{color:#93c5fd;text-decoration:none}
  </style>
</head>
<body>
<div class="wrap">
  <h2>دمج ملفات PDF</h2>
  <div class="card">
    <form id="form" action="/api/merge-pdf" method="post" enctype="multipart/form-data">
      <input id="files" type="file" name="files" accept="application/pdf" multiple hidden />
      <div style="text-align:center">
        <button type="button" id="pick" class="btn">اختر ملفات PDF</button>
        <div class="muted">أو اسحبها إلى الصندوق أدناه</div>
      </div>

      <div id="drop" class="drop">اسحب ملفات PDF هنا</div>

      <div class="row">
        <div style="flex:1 1 240px">
          <label>اسم الملف الناتج:</label>
          <input type="text" name="outfile" value="merged.pdf">
        </div>
        <div style="flex:1 1 200px">
          <label>الترتيب:</label>
          <select name="order">
            <option value="name">حسب الاسم (تصاعدي)</option>
            <option value="as_is">كما تم اختيارها</option>
          </select>
        </div>
      </div>

      <div style="margin-top:14px;display:flex;gap:10px;align-items:center;flex-wrap:wrap">
        <button class="btn" type="submit">دمج الآن</button>
        <a class="link" href="/">الرجوع للصور → PDF</a>
      </div>

      <div id="count" class="muted" style="margin-top:8px">لا توجد ملفات محددة</div>
    </form>
  </div>
</div>

<script>
  const files = document.getElementById('files');
  const pick  = document.getElementById('pick');
  const drop  = document.getElementById('drop');
  const form  = document.getElementById('form');
  const count = document.getElementById('count');

  pick.onclick = ()=> files.click();

  ['dragenter','dragover'].forEach(ev=>{
    drop.addEventListener(ev, e=>{ e.preventDefault(); drop.classList.add('drag'); });
  });
  ['dragleave','drop'].forEach(ev=>{
    drop.addEventListener(ev, e=>{ e.preventDefault(); drop.classList.remove('drag'); });
  });
  drop.addEventListener('drop', e=>{
    files.files = e.dataTransfer.files; update();
  });
  files.addEventListener('change', update);

  function update(){
    const n = files.files?.length || 0;
    count.textContent = n ? `${n} ملف/ملفات محددة` : 'لا توجد ملفات محددة';
  }

  form.addEventListener('submit', (e)=>{
    if(!files.files?.length){ e.preventDefault(); alert('اختر ملفات PDF أولاً.'); }
  });
</script>
</body>
</html>
