<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{{ title or site_name }}</title>

  <style>
    /* ===================  THEME TOKENS  =================== */
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --surface:#ffffff;
      --ink:#1f2937;
      --ink-dim:#6b7280;
      --brand:#ef4444;
      --brand2:#ec4899;
      --ring:rgba(239,68,68,.35);
      --border:#e5e7eb;
      --muted:#f9fafb;
      --shadow:0 18px 45px rgba(0,0,0,.06);
    }

    /* Force LIGHT via class */
    body.theme-light{
      --bg:#f6f7fb; --card:#ffffff; --surface:#ffffff;
      --ink:#1f2937; --ink-dim:#6b7280;
      --brand:#ef4444; --brand2:#ec4899;
      --ring:rgba(239,68,68,.35);
      --border:#e5e7eb; --muted:#f9fafb;
      --shadow:0 18px 45px rgba(0,0,0,.06);
    }

    /* Force DARK via class */
    body.theme-dark{
      --bg:#0b1118;
      --card:#0f1623;
      --surface:#0b1220;
      --ink:#e6ebf0;
      --ink-dim:#9fb0c3;
      --brand:#f43f5e;
      --brand2:#8b5cf6;
      --ring:rgba(139,92,246,.35);
      --border:#1b2533;
      --muted:#0b121c;
      --shadow:0 18px 45px rgba(5,10,20,.55);
    }

    /* ÿßÿ™Ÿëÿ®ÿßÿπ ÿßŸÑŸÜÿ∏ÿßŸÖ ÿ•ÿ∞ÿß ŸÑÿß ŸäŸàÿ¨ÿØ ŸÉŸÑÿßÿ≥ */
    @media (prefers-color-scheme: dark){
      body:not(.theme-light):not(.theme-dark){
        --bg:#0b1118; --card:#0f1623; --surface:#0b1220;
        --ink:#e6ebf0; --ink-dim:#9fb0c3;
        --brand:#f43f5e; --brand2:#8b5cf6;
        --ring:rgba(139,92,246,.35);
        --border:#1b2533; --muted:#0b121c;
        --shadow:0 18px 45px rgba(5,10,20,.55);
      }
    }

    /* ===================  BASE  =================== */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family: system-ui, -apple-system, "Segoe UI", Tahoma, Arial, sans-serif;
      background: var(--bg);
      color:var(--ink);
      position:relative;
      min-height:100vh;
      overflow-x:hidden;
    }

    /* Dots Grid */
    body::before{
      content:""; position:fixed; inset:0; pointer-events:none; z-index:-1;
      background:
        radial-gradient(rgba(0,0,0,.035) 1px, transparent 1px) 0 0/22px 22px,
        radial-gradient(rgba(0,0,0,.025) 1px, transparent 1px) 11px 11px/22px 22px;
      -webkit-mask-image: linear-gradient(to bottom, rgba(0,0,0,.25), rgba(0,0,0,.05));
              mask-image: linear-gradient(to bottom, rgba(0,0,0,.25), rgba(0,0,0,.05));
    }
    @media (prefers-color-scheme: dark){
      body:not(.theme-light):not(.theme-dark)::before{
        background:
          radial-gradient(rgba(255,255,255,.05) 1px, transparent 1px) 0 0/22px 22px,
          radial-gradient(rgba(255,255,255,.035) 1px, transparent 1px) 11px 11px/22px 22px;
        -webkit-mask-image: linear-gradient(to bottom, rgba(0,0,0,.45), rgba(0,0,0,.16));
                mask-image: linear-gradient(to bottom, rgba(0,0,0,.45), rgba(0,0,0,.16));
      }
    }
    body.theme-dark::before{
      background:
        radial-gradient(rgba(255,255,255,.05) 1px, transparent 1px) 0 0/22px 22px,
        radial-gradient(rgba(255,255,255,.035) 1px, transparent 1px) 11px 11px/22px 22px;
      -webkit-mask-image: linear-gradient(to bottom, rgba(0,0,0,.45), rgba(0,0,0,.16));
              mask-image: linear-gradient(to bottom, rgba(0,0,0,.45), rgba(0,0,0,.16));
    }

    /* Blobs */
    .body-blobs{ position:fixed; inset:0; z-index:-2; pointer-events:none; overflow:hidden; }
    .blob{
      position:absolute; border-radius:50%;
      filter:blur(70px); opacity:.18; will-change: transform;
      animation: float 18s ease-in-out infinite alternate;
    }
    .blob.p1{ width:min(36vw,420px); height:min(36vw,420px); background:#ec4899; top:-18vh; right:8%; }
    .blob.p2{ width:min(46vw,520px); height:min(46vw,520px); background:#ef4444; bottom:-22vh; left:6%; animation-delay:4s; }
    .blob.p3{ width:min(36vw,400px); height:min(36vw,400px); background:#3b82f6; top:35%; left:58%; opacity:.12; animation-delay:8s; }
    body.theme-dark .blob{ opacity:.10 }
    @keyframes float{ to{ transform:translate3d(12px,-20px,0) scale(1.035); opacity:.2; } }

    /* Layout */
    .container{max-width:1100px;margin:auto;padding:0 16px}
    .hero{padding:32px 0 8px}
    .grid{display:grid;grid-template-columns:1fr;gap:24px;padding-bottom:32px}
    @media (min-width:900px){ .grid{grid-template-columns:1.2fr .8fr} }

    /* Header */
    header{
      position:sticky;top:0;z-index:20;
      background: rgba(255,255,255,.8);
      border-bottom:1px solid var(--border);
      backdrop-filter:saturate(180%) blur(8px);
    }
    @media (prefers-color-scheme: dark){
      body:not(.theme-light):not(.theme-dark) header{
        background: rgba(15,22,35,.78);
        border-bottom-color: var(--border);
      }
    }
    body.theme-dark header{
      background: rgba(15,22,35,.78);
      border-bottom-color: var(--border);
    }

    .nav{
      display:flex;align-items:center;justify-content:space-between;
      padding:14px 16px; max-width:1100px; margin:auto; gap:10px;
    }
    .brand{ display:flex;align-items:center;gap:10px; font-weight:800; font-size:1.1rem; }
    .logo{
      width:28px;height:28px;border-radius:8px;
      background:linear-gradient(135deg,var(--brand),var(--brand2));
      box-shadow:0 6px 18px rgba(239,68,68,.35);
    }

    /* ===== Tabs (PRO STYLE) ===== */
    .tabs{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }
    .tab{
      padding:8px 16px;
      border-radius:12px;
      text-decoration:none;
      color:var(--ink-dim);
      font-weight:600;
      position:relative;
      transition:all .25s ease;
    }
    .tab:hover{
      background:rgba(255,255,255,.08);
      color:var(--ink);
    }
    .tab.active{
      color:#fff;
      background:linear-gradient(135deg,var(--brand),var(--brand2));
      box-shadow:0 0 14px rgba(239,68,68,.45);
    }
    body.theme-light .tab.active{
      color:#fff;
      box-shadow:0 0 10px rgba(239,68,68,.25);
    }

    /* Cards & controls */
    .card{
      background:var(--card);border:1px solid var(--border);border-radius:18px;padding:18px;
      box-shadow:var(--shadow);
      color:var(--ink);
    }
    .btn{
      appearance:none;cursor:pointer;border:none;text-decoration:none;
      display:inline-flex;align-items:center;justify-content:center;
      padding:10px 16px;border-radius:12px;background:linear-gradient(135deg,var(--brand),var(--brand2));color:#fff;font-weight:700;
      box-shadow:0 8px 24px rgba(239,68,68,.35);transition:transform .05s ease, box-shadow .2s ease
    }
    .btn:hover{transform:translateY(-1px)}
    .btn.muted{background:var(--surface);color:var(--ink);border:1px solid var(--border);box-shadow:none}

    .row{display:flex;gap:10px;flex-wrap:wrap}
    input[type="text"], select{
      border:1px solid var(--border);border-radius:12px;padding:10px 12px;background:var(--surface);color:var(--ink);
      outline:none;min-width:200px
    }
    input[type="text"]:focus, select:focus{box-shadow:0 0 0 4px var(--ring)}
    input::placeholder{color:var(--ink-dim)}
    label.chip{display:flex;align-items:center;gap:8px;padding:8px 10px;border:1px solid var(--border);border-radius:999px;background:var(--surface);color:var(--ink)}
    .sub{color:var(--ink-dim);font-size:.92rem}
    .drop{border:2px dashed var(--border);background:var(--surface);color:var(--ink-dim);border-radius:14px;padding:24px;text-align:center;transition:.2s}
    .drop.drag{background:var(--muted);border-color:#9ca3af}

    /* Footer */
    footer{
      padding:32px 16px;text-align:center;color:var(--ink-dim);margin-top:40px;
      font-size:.92rem;
    }
    footer a{ color:var(--ink-dim); text-decoration:none; margin:0 6px }
    footer a:hover{ color:var(--brand) }

    /* Theme toggle button */
    .theme-btn{
      min-width:40px; height:40px; padding:0 10px;
      border-radius:10px; font-size:18px; line-height:1;
      margin-inline-start:8px;
    }
    .theme-btn:focus{ outline:none; box-shadow:0 0 0 4px var(--ring) }
  </style>

  {% block extra_css %}{% endblock %}
</head>
<body>

  <!-- ÿÆŸÑŸÅŸäÿ© ÿßŸÑŸÅŸÇÿßÿπÿßÿ™ -->
  <div class="body-blobs">
    <div class="blob p1"></div>
    <div class="blob p2"></div>
    <div class="blob p3"></div>
  </div>

  <!-- ÿßŸÑŸáŸäÿØÿ± -->
  <header>
    <div class="nav">
      <div class="brand">
        <span class="logo"></span>
        <span>{{ site_name }}</span>
      </div>

      <nav class="tabs">
        <a href="/" class="tab {% if active == 'img2pdf' %}active{% endif %}">ÿµŸàÿ± ‚Üí PDF</a>
        <a href="/merge/pdf" class="tab {% if active == 'merge' %}active{% endif %}">ÿØŸÖÿ¨ PDF</a>
        <a href="/compress/pdf" class="tab {% if active == 'compress' %}active{% endif %}">ÿ∂ÿ∫ÿ∑ PDF</a>
      </nav>

      <button id="themeToggle" class="btn muted theme-btn" type="button" aria-label="ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑÿ≥ŸÖÿ©" title="ÿ™ÿ®ÿØŸäŸÑ ÿßŸÑÿ≥ŸÖÿ©">
        üñ•Ô∏è
      </button>
    </div>
  </header>

  {% block content %}{% endblock %}

  <footer>
    ¬© {{ current_year() }} ‚Äî ÿ£ÿØÿßÿ© PDF ÿ®ÿ≥Ÿäÿ∑ÿ© ¬∑
    <a href="/about">ŸÖŸÜ ŸÜÿ≠ŸÜ</a> ¬∑
    <a href="/privacy">ÿ≥Ÿäÿßÿ≥ÿ© ÿßŸÑÿÆÿµŸàÿµŸäÿ©</a> ¬∑
    <a href="/cookies">ŸÖŸÑŸÅÿßÿ™ ÿßŸÑÿßÿ±ÿ™ÿ®ÿßÿ∑</a> ¬∑
    <a href="/contact">ÿßÿ™ÿµŸÑ ÿ®ŸÜÿß</a>
  </footer>

  {% block extra_js %}{% endblock %}

  <script>
    (function(){
      const KEY = 'theme';
      const btn = document.getElementById('themeToggle');

      function applyTheme(mode){
        document.body.classList.remove('theme-light','theme-dark');
        if(mode === 'light'){ document.body.classList.add('theme-light'); }
        else if(mode === 'dark'){ document.body.classList.add('theme-dark'); }
        // system => ŸÑÿß ŸÉŸÑÿßÿ≥
        setButtonIcon(mode);
      }
      function setButtonIcon(mode){
        if(!btn) return;
        if(mode === 'light'){ btn.textContent = 'üåû'; btn.title = 'ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÅÿßÿ™ÿ≠ (ÿßÿ∂ÿ∫ÿ∑ ŸÑŸÑÿ™ÿ®ÿØŸäŸÑ)'; }
        else if(mode === 'dark'){ btn.textContent = 'üåô'; btn.title = 'ÿßŸÑŸàÿ∂ÿπ ÿßŸÑÿØÿßŸÉŸÜ (ÿßÿ∂ÿ∫ÿ∑ ŸÑŸÑÿ™ÿ®ÿØŸäŸÑ)'; }
        else { btn.textContent = 'üñ•Ô∏è'; btn.title = 'ÿßÿ™ÿ®ÿßÿπ ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ¨Ÿáÿßÿ≤ (ÿßÿ∂ÿ∫ÿ∑ ŸÑŸÑÿ™ÿ®ÿØŸäŸÑ)'; }
      }

      let saved = localStorage.getItem(KEY) || 'system';
      applyTheme(saved);

      const media = window.matchMedia('(prefers-color-scheme: dark)');
      media.addEventListener?.('change', () => {
        const current = localStorage.getItem(KEY) || 'system';
        if(current === 'system'){ applyTheme('system'); }
      });

      btn?.addEventListener('click', () => {
        const current = localStorage.getItem(KEY) || 'system';
        const next = current === 'light' ? 'dark'
                     : current === 'dark' ? 'system'
                     : 'light';
        localStorage.setItem(KEY, next);
        applyTheme(next);
      });
    })();
  </script>
</body>
</html>
